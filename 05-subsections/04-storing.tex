\section{Storing the Data}\label{sec: 5-storing}
In this section, we discuss how the filtered documents are stored and how Neo4j was used for storing extracted relations, following the design described in section \ref{sec:storage-design}. We discuss the storage and graph database parts from the overview (see figure \ref{fig:overview}).

\subsection{Storing Filtered Documents}
The documents that pass the filtering stage can be stored for several reasons. For example, the classifier can be retrained and might thus label documents differently. To avoid having to download and process all the pages again, it is useful to store the documents on disk. If the disk is small, it is wise to compress the documents. However, compression is a slow process, so if enough disk space is available, storing the documents uncompressed is more feasible.

In the \texttt{TextDownloader} class, that was already shortly discussed in section \ref{sec:5-downloading}, storage to disk is done without compression in all cases. We did this since this project only involves a relatively small data set, e.g. one that can be stored without the need for compression.

\subsection{Storing Extracted Data}
To be able to interact with the results of the application, it is required to store extracted relations. The implementation of the storage follows the design of section section \ref{sec:storing-data}, using the graph database Neo4j.

\subsubsection{Neo4j Model}
The model used for the graph structure follows the concepts described in section \ref{lst:neo4j-concepts}. It consists of nodes, labels and properties. To distinguish between and to efficiently query for specific (types of) nodes, at least one label is assigned to the node. The following labels are used:

\begin{description}
\item[\textbf{\texttt{:City}}] 
\item[\textbf{\texttt{:Index}}] Nodes with the \texttt{:Index} label represent documents that are found useful. Every document has this label, in addition to the label representing the category they are classified as.
\item[Categories] For each category, a label exists to separate a category from the bulk of documents. This way, documents of a specific category can be matched against. This is particularly useful to count, for example, the documents about "Leisure" (and thus labelled \texttt{:Leisure}), that two cities have in common.
\end{description}

% relation types
% properties
% db_utils

% steden op basis van lijst van klant, coordinaten opgezocht via google api
% issue: steden met dubbele naam kregen zelfde coordinaten en niet per se de grootste, maar belangrijkste (volgens google)
% neo4j city node
% neo4j index node
% occurrence relation
% intercity relation
% parameterised optimisation -> benchmark
% bulk vs single -> single transaction instead of transaction for every statement, benchmark
% transactional vs multithreaded -> data inconsistencies
% neo4j python driver issues
% solution: use neo4j's own multi-threading using UNWIND -> embedded multithreading
% remarks: 
% try SQL instead of NoSQL to compare results
% perhaps java instead of python driver to be able to use multithreading
\todo{mention multithreading neo4j (embedded)}